---
import Listing from "../components/Listing.jsx";
const allPages = Astro.fetchContent("../pages/work/*.md");

const allTags = new Set();
allPages.map((page) => {
  page.tags && page.tags.map((tag) => allTags.add(tag.toLowerCase()));
});

const { tags } = Astro.props;
---

{tags &&
  tags.map((tag) => {
    const filteredPages = allPages.filter(
      (page) =>
        page.tags &&
        page.tags.includes(tag) &&
        page.url != Astro.request.url.pathname
    );
    return (
      filteredPages.length > 0 && (
        <Listing
          slot="footer"
          title={`More in #${tag}`}
          items={filteredPages}
        />
      )
    );
  })}
